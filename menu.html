<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0f1a" />
  <title>CYBER DRAGON ‚Äî Mobile</title>
  <style>
    :root{
      --bg:#0b0f1a; --glass:rgba(12,16,28,.55); --glass-strong:rgba(20,28,46,.72);
      --line:rgba(255,255,255,.12); --text:#eaf6ff; --muted:#9fb3c8;
      --brandA:#4fd3ff; --brandB:#8f00ff; --ok:#4ade80; --warn:#f59e0b; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{ -webkit-text-size-adjust:100% }
    body{
      margin:0;color:var(--text);
      background:
        radial-gradient(1200px 1200px at 15% -10%, #183055 0%, transparent 60%),
        radial-gradient(1200px 1200px at 85% 110%, #2a1250 0%, transparent 55%),
        var(--bg);
      font:16px/1.48 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
      -webkit-tap-highlight-color: transparent;
    }
    .app{
      max-width:430px;margin:0 auto;
      padding: calc(14px + env(safe-area-inset-top)) calc(14px + env(safe-area-inset-right))
               calc(28px + env(safe-area-inset-bottom)) calc(14px + env(safe-area-inset-left));
      min-height:100dvh; overscroll-behavior-y: contain;
    }

    /* Header */
    .header{position:sticky; top:0; z-index:30; margin:-6px -4px 8px}
    .bar{
      display:flex;align-items:center;gap:10px;padding:8px;
      backdrop-filter:saturate(140%) blur(12px);
      background:linear-gradient(to bottom, rgba(10,15,26,.75), rgba(10,15,26,.35));
      border-bottom:1px solid var(--line); border-radius:16px;
    }
    .brand{margin:0;font-size:1.06rem;letter-spacing:.35px;text-shadow:0 1px 6px #0009;display:flex;align-items:center;gap:6px}
    .brand .mark{height:18px;width:auto;vertical-align:middle;filter:drop-shadow(0 0 6px #00eaff66)}
    .lang{margin-left:auto;display:flex;align-items:center;gap:6px}
    .lang select{
      appearance:none;border-radius:10px;padding:10px 28px 10px 12px;
      color:var(--text);background:var(--glass-strong);border:1px solid var(--line);outline:none;min-height:44px;
    }
    .burger{
      width:44px;height:44px;border-radius:12px;border:1px solid var(--line);
      background:var(--glass-strong);color:#fff;display:grid;place-items:center;cursor:pointer;touch-action:manipulation;
    }
    .burger:active{transform:scale(.98)}
    .nav-pop{
      position:absolute;right:14px;top:64px;background:rgba(10,14,24,.94);backdrop-filter:blur(14px) saturate(140%);
      border:1px solid var(--line);border-radius:14px;padding:8px;display:none;min-width:220px;z-index:40
    }
    .nav-pop.open{display:block}
    .nav-pop a,.nav-pop .lang-inline{
      display:flex;align-items:center;gap:10px;padding:12px;border-radius:10px;color:#fff;text-decoration:none;min-height:44px
    }
    .nav-pop a:hover,.nav-pop .lang-inline:hover{background:var(--glass)}
    .nav-pop hr{border:0;height:1px;background:var(--line);margin:6px 0}
    .nav-pop .lang-inline select{flex:1;background:var(--glass-strong);border:1px solid var(--line);color:#fff;border-radius:10px;padding:8px 10px;min-height:44px}

    /* Category pills */
    .h-scroll{display:flex;gap:8px;overflow:auto;scroll-snap-type:x proximity;padding:6px 0}
    .pill{
      scroll-snap-align:start;white-space:nowrap;padding:10px 14px;border-radius:999px;border:1px solid var(--line);
      background:var(--glass);backdrop-filter:blur(8px);color:#fff;cursor:pointer;min-height:44px
    }
    .pill:active{transform:scale(.98)}
    .pill.active{background:linear-gradient(90deg,var(--brandA),var(--brandB));color:#001027;border:none;font-weight:700}

    /* GRID like screenshot */
    .list{
      display:grid;gap:10px;margin-top:8px;
      grid-template-columns:repeat(2, minmax(0,1fr));
    }
    .card{
      display:grid;grid-template-rows:auto auto auto;gap:8px;
      padding:10px;border-radius:16px;background:var(--glass);border:1px solid var(--line);backdrop-filter:blur(10px);
      position:relative; overflow:hidden;
    }
    .thumb-wrap{position:relative}
    .thumb{width:100%;aspect-ratio:1/1;border-radius:12px;overflow:hidden;background:linear-gradient(135deg,#3a517f,#7a45cc)}
    .thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:block}
    .thumb.noimg{background:linear-gradient(135deg,#334b7a,#6842a6)}
    .info{
      position:absolute;right:8px;top:8px;width:28px;height:28px;border-radius:999px;border:1px solid var(--line);
      background:var(--glass-strong);color:#fff;cursor:pointer;display:grid;place-items:center;font-weight:800
    }
    .name{font-weight:800;line-height:1.2;min-height:2.4em}
    .desc{display:none;color:var(--muted);font-size:.92rem}
    .card.expanded .desc{display:block}
    .foot{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .price{font-weight:800}
    .add{
      border:none;border-radius:999px;padding:10px 14px;background:linear-gradient(90deg,var(--brandA),var(--brandB));
      color:#001027;font-weight:800;cursor:pointer;min-height:40px;flex:1
    }
    .qty{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);border-radius:999px;padding:6px 8px}
    .qty button{
      width:32px;height:32px;border:none;border-radius:10px;background:var(--glass-strong);color:#fff;cursor:pointer
    }

    /* FAB cart */
    .fab{position:sticky;bottom:calc(14px + env(safe-area-inset-bottom));display:flex;justify-content:center;margin-top:14px;z-index:35}
    .cart-fab{
      display:inline-flex;align-items:center;gap:10px;border:none;border-radius:999px;padding:12px 18px;cursor:pointer;color:#001027;
      background:linear-gradient(90deg,var(--brandA),var(--brandB));font-weight:800;box-shadow:0 18px 28px #001a2f66;min-height:48px
    }

    /* Overlay + bottom sheet */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);opacity:0;pointer-events:none;transition:.2s opacity;z-index:40}
    .overlay.show{opacity:1;pointer-events:auto}
    .sheet{
      position:fixed; left:0; right:0; bottom:0;
      width:100%; max-width:430px; margin:0 auto;
      background:rgba(10,14,24,.96);backdrop-filter:blur(16px) saturate(140%);
      border-top-left-radius:18px;border-top-right-radius:18px;border:1px solid var(--line);
      padding:14px; padding-bottom:calc(14px + env(safe-area-inset-bottom));
      transition:.25s transform; transform:translateY(100%);
      z-index:41; max-height:85dvh; overflow:auto; overscroll-behavior:contain;
    }
    .sheet.open{ transform:translateY(0) }
    .sheet h3{margin:0 0 8px}

    .cart-lines{display:grid;gap:10px;max-height:38dvh;overflow:auto;padding-right:4px}
    .line{display:grid;grid-template-columns:1fr auto;align-items:center;gap:10px;padding:8px;border-radius:12px;border:1px dashed var(--line)}
    .section{margin-top:10px}
    .group{display:flex;gap:8px;flex-wrap:wrap}
    .chip{padding:10px 14px;border-radius:999px;background:var(--glass);border:1px solid var(--line);cursor:pointer;min-height:44px}
    .chip.active{background:linear-gradient(90deg,var(--brandA),var(--brandB));color:#001027;border:none;font-weight:800}
    .field{display:grid;gap:6px;margin-top:8px}
    .field input,.field textarea,.field select{
      border-radius:10px;padding:12px;background:var(--glass-strong);color:#fff;border:1px solid var(--line);outline:none;font-size:1rem;min-height:44px
    }
    .field textarea{min-height:72px;resize:vertical}
    .checkout{display:grid;gap:8px;margin-top:10px}
    .btn{border:none;border-radius:14px;padding:12px 14px;font-weight:800;cursor:pointer;min-height:48px}
    .btn.primary{background:linear-gradient(90deg,var(--brandA),var(--brandB));color:#001027}
    .btn.ghost{background:transparent;border:1px dashed var(--line);color:#fff}
    .muted{color:var(--muted)}

    /* –ú—è–≥–∫–∏–µ —Å–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–µ —É–≥–ª—ã —É —Ñ–æ—Ç–æ –±–ª—é–¥ */
    .thumb{
      border-radius: 20px;   /* –º–æ–∂–Ω–æ 16‚Äì24 ‚Äî –∫–∞–∫ –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è */
      overflow: hidden;      /* —á—Ç–æ–±—ã –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ ‚Äú—Ç–æ—Ä—á–∞–ª–∞‚Äù –∑–∞ —Ä–∞–¥–∏—É—Å */
    }

    /* –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π ‚Äî —Å–∫—Ä—É–≥–ª–∏—Ç—å –∏ —Å–∞–º —Ç–µ–≥ img */
    .thumb img{
      border-radius: inherit;
    }

    /* –§–∏–∫—Å –¥–ª—è —Ä–µ–¥–∫–∏—Ö –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ */
    @supports (clip-path: inset(0 round 20px)){
      .thumb{ clip-path: inset(0 round 20px); }
    }


  </style>
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <div class="bar">
        <h1 class="brand">
          CYBER <img class="mark" src="logo.png" alt="Logo"> DRAGON
        </h1>

        <div class="lang" title="Language">
          <select id="langSel" aria-label="Language">
            <option value="ru">RU</option><option value="en">EN</option>
            <option value="ua">UA</option><option value="vn">VN</option>
            <option value="pl">PL</option><option value="de">DE</option>
            <option value="zh">ZH</option>
          </select>
        </div>

        <button class="burger" id="burger" aria-haspopup="true" aria-expanded="false" aria-controls="navPop">‚ò∞</button>
        <nav class="nav-pop" id="navPop" role="menu" aria-label="Main menu">
          <a href="index.html" id="navHome" role="menuitem">üè† HOME</a>
          <a href="#" id="navMenu" role="menuitem">üçú MENU</a>
          <a href="#" id="navKaraoke" role="menuitem">üé§ KARAOKE</a>
          <a href="#" id="navContact" role="menuitem">üìû KONTAKT</a>
          <hr>
          <div class="lang-inline" role="none">
            üåê <select id="langSelMenu" aria-label="Language (menu)">
              <option value="ru">RU</option><option value="en">EN</option>
              <option value="ua">UA</option><option value="vn">VN</option>
              <option value="pl">PL</option><option value="de">DE</option>
              <option value="zh">ZH</option>
            </select>
          </div>
        </nav>
      </div>
    </header>

    <!-- Categories -->
    <div class="h-scroll" id="catPills" aria-label="Categories"></div>

    <!-- Items GRID -->
    <div class="list" id="list"></div>

    <!-- FAB -->
    <div class="fab">
      <button class="cart-fab" id="cartFab" aria-haspopup="dialog">üõí <span id="fabText">0 —à—Ç. ‚Ä¢ 0.00 ‚Ç¨</span></button>
    </div>
  </div>

  <!-- Sheet -->
  <div class="overlay" id="overlay"></div>
  <div class="sheet" id="sheet" role="dialog" aria-modal="true" aria-labelledby="sheetTitle">
    <h3 id="sheetTitle"></h3>
    <div class="cart-lines" id="cartLines"></div>

    <!-- Order type -->
    <div class="section">
      <div class="muted" id="orderTypeTitle" style="margin-bottom:6px">–¢–∏–ø –∑–∞–∫–∞–∑–∞</div>
      <div class="group" id="orderType">
        <button class="chip active" data-ot="on_site" id="otOnSite">–ù–∞ –º–µ—Å—Ç–µ</button>
        <button class="chip" data-ot="takeaway" id="otTakeaway">–ù–∞ –≤—ã–Ω–æ—Å</button>
        <button class="chip" data-ot="delivery" id="otDelivery">–î–æ—Å—Ç–∞–≤–∫–∞</button>
      </div>

      <div class="field" id="tableField" style="display:grid">
        <label for="tableNo" id="tableLbl">–°—Ç–æ–ª <span class="muted">(–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></label>
        <input id="tableNo" type="number" min="1" inputmode="numeric" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 5">
      </div>

      <div class="field" id="takeawayField" style="display:none">
        <label for="pickupIn" id="pickupLbl">–ß–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ –∑–∞–±—Ä–∞—Ç—å (–º–∏–Ω) <span class="muted">(–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></label>
        <input id="pickupIn" type="number" min="5" step="5" placeholder="15">
      </div>

      <div class="field" id="addrField" style="display:none">
        <label for="address" id="addrLbl">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ <span class="muted">(–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></label>
        <textarea id="address" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –ø–æ–¥—ä–µ–∑–¥..."></textarea>
      </div>

      <div class="field" id="phoneField">
        <label for="phone" id="phoneLbl">–¢–µ–ª–µ—Ñ–æ–Ω <span class="muted" id="phoneHint">(–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></label>
        <input id="phone" type="tel" placeholder="+48 600 000 000">
      </div>
    </div>

    <div class="checkout">
      <div class="muted" id="cartMeta">–ò—Ç–æ–≥–æ: 0.00 ‚Ç¨</div>
      <button class="btn primary" id="checkoutBtn">–û—Ñ–æ—Ä–º–∏—Ç—å</button>
      <button class="btn ghost" id="clearBtn">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
    </div>
  </div>

  <!-- Data -->
  <script src="menu.js"></script>
  <script>
  // ---------- SETTINGS ----------
  let LANG='ru'; document.documentElement.lang=LANG;
  const CURRENCY='‚Ç¨';
  const USE_IMAGES=true;
  const IMG_DIR='images/'; const IMG_EXTS=['webp','jpg','jpeg','png'];

  // ---------- I18N ----------
  const I18N={};
  I18N.ru={navHome:'–ì–ª–∞–≤–Ω–∞—è',navMenu:'–ú–µ–Ω—é',navKaraoke:'–ö–∞—Ä–∞–æ–∫–µ',navContact:'–ö–æ–Ω—Ç–∞–∫—Ç—ã',
    sheetTitle:'–í–∞—à –∑–∞–∫–∞–∑',orderTypeTitle:'–¢–∏–ø –∑–∞–∫–∞–∑–∞',otOnSite:'–ù–∞ –º–µ—Å—Ç–µ',otTakeaway:'–ù–∞ –≤—ã–Ω–æ—Å',otDelivery:'–î–æ—Å—Ç–∞–≤–∫–∞',
    tableLbl:'–°—Ç–æ–ª',pickupLbl:'–ß–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ –∑–∞–±—Ä–∞—Ç—å (–º–∏–Ω)',addrLbl:'–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏',
    phoneLbl:'–¢–µ–ª–µ—Ñ–æ–Ω',phoneOptional:'(–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)',phoneRequired:'(–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)',
    total:'–ò—Ç–æ–≥–æ',checkout:'–û—Ñ–æ—Ä–º–∏—Ç—å',clear:'–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É',cartEmpty:'–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞.',
    add:'–î–æ–±–∞–≤–∏—Ç—å',itemsShort:'—à—Ç.',alertTable:'–£–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä —Å—Ç–æ–ª–∞.',alertPickup:'–£–∫–∞–∂–∏—Ç–µ —á–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –∑–∞–±—Ä–∞—Ç—å.',
    alertPhone:'–£–∫–∞–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω.',alertAddr:'–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏.',orderAccepted:'–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç ‚úî',typeLabel:'–¢–∏–ø',
    comp:'–°–æ—Å—Ç–∞–≤',allergens:'–ê–ª–ª–µ—Ä–≥–µ–Ω—ã',spicy:'–û—Å—Ç—Ä–æ—Ç–∞',kcal:'–ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å',portion:'–ü–æ—Ä—Ü–∏—è'};
  I18N.en={navHome:'Home',navMenu:'Menu',navKaraoke:'Karaoke',navContact:'Contact',
    sheetTitle:'Your order',orderTypeTitle:'Order type',otOnSite:'Dine-in',otTakeaway:'Takeaway',otDelivery:'Delivery',
    tableLbl:'Table',pickupLbl:'Pickup in (min)',addrLbl:'Delivery address',phoneLbl:'Phone',phoneOptional:'(optional)',phoneRequired:'(required)',
    total:'Total',checkout:'Checkout',clear:'Clear cart',cartEmpty:'Cart is empty.',add:'Add',itemsShort:'pcs',
    alertTable:'Please enter table number.',alertPickup:'Please enter pickup minutes.',alertPhone:'Please enter phone.',alertAddr:'Please enter delivery address.',
    orderAccepted:'Order accepted ‚úî',typeLabel:'Type',comp:'Ingredients',allergens:'Allergens',spicy:'Spice',kcal:'Calories',portion:'Portion'};
  I18N.ua={navHome:'–ì–æ–ª–æ–≤–Ω–∞',navMenu:'–ú–µ–Ω—é',navKaraoke:'–ö–∞—Ä–∞–æ–∫–µ',navContact:'–ö–æ–Ω—Ç–∞–∫—Ç–∏',
    sheetTitle:'–í–∞—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è',orderTypeTitle:'–¢–∏–ø –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è',otOnSite:'–ù–∞ –º—ñ—Å—Ü—ñ',otTakeaway:'–ó —Å–æ–±–æ—é',otDelivery:'–î–æ—Å—Ç–∞–≤–∫–∞',
    tableLbl:'–°—Ç—ñ–ª',pickupLbl:'–ß–µ—Ä–µ–∑ —Å–∫—ñ–ª—å–∫–∏ –∑–∞–±—Ä–∞—Ç–∏ (—Ö–≤)',addrLbl:'–ê–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏',phoneLbl:'–¢–µ–ª–µ—Ñ–æ–Ω',
    phoneOptional:'(–Ω–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ)',phoneRequired:'(–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ)',total:'–†–∞–∑–æ–º',checkout:'–û—Ñ–æ—Ä–º–∏—Ç–∏',clear:'–û—á–∏—Å—Ç–∏—Ç–∏ –∫–æ—à–∏–∫',
    cartEmpty:'–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π.',add:'–î–æ–¥–∞—Ç–∏',itemsShort:'—à—Ç.',alertTable:'–í–∫–∞–∂—ñ—Ç—å –Ω–æ–º–µ—Ä —Å—Ç–æ–ª—É.',alertPickup:'–í–∫–∞–∂—ñ—Ç—å —á–µ—Ä–µ–∑ —Å–∫—ñ–ª—å–∫–∏ —Ö–≤–∏–ª–∏–Ω –∑–∞–±—Ä–∞—Ç–∏.',
    alertPhone:'–í–∫–∞–∂—ñ—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω.',alertAddr:'–í–∫–∞–∂—ñ—Ç—å –∞–¥—Ä–µ—Å—É –¥–æ—Å—Ç–∞–≤–∫–∏.',orderAccepted:'–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–π–Ω—è—Ç–æ ‚úî',typeLabel:'–¢–∏–ø',
    comp:'–°–∫–ª–∞–¥',allergens:'–ê–ª–µ—Ä–≥–µ–Ω–∏',spicy:'–ì–æ—Å—Ç—Ä–æ—Ç–∞',kcal:'–ö–∞–ª–æ—Ä—ñ–π–Ω—ñ—Å—Ç—å',portion:'–ü–æ—Ä—Ü—ñ—è'};
  I18N.vn={navHome:'Trang ch·ªß',navMenu:'Th·ª±c ƒë∆°n',navKaraoke:'Karaoke',navContact:'Li√™n h·ªá',
    sheetTitle:'ƒê∆°n h√†ng c·ªßa b·∫°n',orderTypeTitle:'H√¨nh th·ª©c',otOnSite:'D√πng t·∫°i ch·ªó',otTakeaway:'Mang ƒëi',otDelivery:'Giao h√†ng',
    tableLbl:'B√†n',pickupLbl:'L·∫•y sau (ph√∫t)',addrLbl:'ƒê·ªãa ch·ªâ giao',phoneLbl:'ƒêi·ªán tho·∫°i',phoneOptional:'(kh√¥ng b·∫Øt bu·ªôc)',phoneRequired:'(b·∫Øt bu·ªôc)',
    total:'T·ªïng',checkout:'ƒê·∫∑t h√†ng',clear:'Xo√° gi·ªè',cartEmpty:'Gi·ªè tr·ªëng.',add:'Th√™m',itemsShort:'m√≥n',
    alertTable:'Nh·∫≠p s·ªë b√†n.',alertPickup:'Nh·∫≠p s·ªë ph√∫t l·∫•y m√≥n.',alertPhone:'Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i.',alertAddr:'Nh·∫≠p ƒë·ªãa ch·ªâ giao.',
    orderAccepted:'ƒê√£ nh·∫≠n ƒë∆°n ‚úî',typeLabel:'Lo·∫°i',comp:'Th√†nh ph·∫ßn',allergens:'D·ªã ·ª©ng',spicy:'ƒê·ªô cay',kcal:'NƒÉng l∆∞·ª£ng',portion:'Kh·∫©u ph·∫ßn'};
  I18N.pl={navHome:'Start',navMenu:'Menu',navKaraoke:'Karaoke',navContact:'Kontakt',
    sheetTitle:'Twoje zam√≥wienie',orderTypeTitle:'Rodzaj zam√≥wienia',otOnSite:'Na miejscu',otTakeaway:'Na wynos',otDelivery:'Dostawa',
    tableLbl:'Stolik',pickupLbl:'Za ile odebraƒá (min)',addrLbl:'Adres dostawy',phoneLbl:'Telefon',phoneOptional:'(opcjonalnie)',phoneRequired:'(wymagane)',
    total:'Razem',checkout:'Zam√≥w',clear:'Wyczy≈õƒá koszyk',cartEmpty:'Koszyk jest pusty.',add:'Dodaj',itemsShort:'szt.',
    alertTable:'Podaj numer stolika.',alertPickup:'Podaj liczbƒô minut do odbioru.',alertPhone:'Podaj telefon.',alertAddr:'Podaj adres dostawy.',
    orderAccepted:'Zam√≥wienie przyjƒôte ‚úî',typeLabel:'Typ',comp:'Sk≈Çad',allergens:'Alergeny',spicy:'Ostro≈õƒá',kcal:'Kalorie',portion:'Porcja'};
  I18N.de={navHome:'Start',navMenu:'Men√º',navKaraoke:'Karaoke',navContact:'Kontakt',
    sheetTitle:'Ihre Bestellung',orderTypeTitle:'Bestellart',otOnSite:'Vor Ort',otTakeaway:'Zum Mitnehmen',otDelivery:'Lieferung',
    tableLbl:'Tisch',pickupLbl:'Abholung in (Min.)',addrLbl:'Lieferadresse',phoneLbl:'Telefon',phoneOptional:'(optional)',phoneRequired:'(erforderlich)',
    total:'Summe',checkout:'Bestellen',clear:'Warenkorb leeren',cartEmpty:'Warenkorb ist leer.',add:'Hinzuf√ºgen',itemsShort:'Stk.',
    alertTable:'Bitte Tischnummer angeben.',alertPickup:'Bitte Abhol-Minuten angeben.',alertPhone:'Bitte Telefon angeben.',alertAddr:'Bitte Lieferadresse angeben.',
    orderAccepted:'Bestellung angenommen ‚úî',typeLabel:'Art',comp:'Zutaten',allergens:'Allergene',spicy:'Sch√§rfe',kcal:'Kalorien',portion:'Portion'};
  I18N.zh={navHome:'‰∏ªÈ°µ',navMenu:'ËèúÂçï',navKaraoke:'Âç°ÊãâOK',navContact:'ËÅîÁ≥ª',
    sheetTitle:'ÊÇ®ÁöÑËÆ¢Âçï',orderTypeTitle:'‰∏ãÂçïÁ±ªÂûã',otOnSite:'Â†ÇÈ£ü',otTakeaway:'Â§ñÂ∏¶',otDelivery:'Â§ñÈÄÅ',
    tableLbl:'Ê°åÂè∑',pickupLbl:'Âá†ÂàÜÈíüÂêéÂèñ',addrLbl:'ÈÖçÈÄÅÂú∞ÂùÄ',phoneLbl:'ÁîµËØù',phoneOptional:'ÔºàÂèØÈÄâÔºâ',phoneRequired:'ÔºàÂøÖÂ°´Ôºâ',
    total:'ÂêàËÆ°',checkout:'‰∏ãÂçï',clear:'Ê∏ÖÁ©∫Ë¥≠Áâ©ËΩ¶',cartEmpty:'Ë¥≠Áâ©ËΩ¶‰∏∫Á©∫„ÄÇ',add:'Âä†ÂÖ•',itemsShort:'‰ª∂',
    alertTable:'ËØ∑ËæìÂÖ•Ê°åÂè∑„ÄÇ',alertPickup:'ËØ∑ËæìÂÖ•ÂèñÈ§êÂàÜÈíü„ÄÇ',alertPhone:'ËØ∑ËæìÂÖ•ÁîµËØù„ÄÇ',alertAddr:'ËØ∑ËæìÂÖ•ÈÖçÈÄÅÂú∞ÂùÄ„ÄÇ',
    orderAccepted:'ËÆ¢ÂçïÂ∑≤Êé•Êî∂ ‚úî',typeLabel:'Á±ªÂûã',comp:'ÈÖçÊñô',allergens:'ËøáÊïèÂéü',spicy:'Ëæ£Â∫¶',kcal:'ÁÉ≠Èáè',portion:'‰ªΩÈáè'};

  // ---------- Categories ----------
  const CAT_LABELS={
    'VORSPEISEN':{ru:'–ó–∞–∫—É—Å–∫–∏',vn:'Khai v·ªã',en:'Starters',ua:'–ó–∞–∫—É—Å–∫–∏',pl:'Przystawki',de:'Vorspeisen',zh:'ÂâçËèú'},
    'HAUPTSPEISEN':{ru:'–û—Å–Ω–æ–≤–Ω—ã–µ –±–ª—é–¥–∞',vn:'M√≥n ch√≠nh',en:'Mains',ua:'–û—Å–Ω–æ–≤–Ω—ñ —Å—Ç—Ä–∞–≤–∏',pl:'Dania g≈Ç√≥wne',de:'Hauptgerichte',zh:'‰∏ªËèú'},
    'SUSHI':{ru:'–°—É—à–∏',vn:'Sushi',en:'Sushi',ua:'–°—É—à—ñ',pl:'Sushi',de:'Sushi',zh:'ÂØøÂè∏'},
    'NACHSPEISEN':{ru:'–î–µ—Å–µ—Ä—Ç—ã',vn:'Tr√°ng mi·ªáng',en:'Desserts',ua:'–î–µ—Å–µ—Ä—Ç–∏',pl:'Desery',de:'Nachspeisen',zh:'ÁîúÂìÅ'},
    'BEILAGEN':{ru:'–ì–∞—Ä–Ω–∏—Ä—ã',vn:'M√≥n ph·ª•',en:'Sides',ua:'–ì–∞—Ä–Ω—ñ—Ä–∏',pl:'Dodatki',de:'Beilagen',zh:'ÈÖçËèú'},
    'GETR√ÑNKE':{ru:'–ù–∞–ø–∏—Ç–∫–∏',vn:'ƒê·ªì u·ªëng',en:'Drinks',ua:'–ù–∞–ø–æ—ó',pl:'Napoje',de:'Getr√§nke',zh:'È•ÆÂìÅ'}
  };
  const catLabel=k=>(CAT_LABELS[k]?.[LANG]||CAT_LABELS[k]?.en||k);

  // ---------- DESCRIPTIONS ----------
  let DESCR={};
  async function loadDescriptions(){
    try{
      const r=await fetch('descriptions.json',{cache:'no-store'});
      if(r.ok){ DESCR=await r.json(); }
    }catch(e){ console.warn('No descriptions.json', e); }
  }

  // ---------- HELPERS ----------
  const $=s=>document.querySelector(s);
  const $$=s=>document.querySelectorAll(s);
  const fmt=n=>(Number(n).toFixed(2)+' '+CURRENCY);
  const itemName=it=>it.translations?.[LANG]||it.translations?.en||it.key.replaceAll('_',' ');

  function getDesc(it){
    const fromJson = DESCR[it.key]?.description;
    return (fromJson && (fromJson[LANG]||fromJson.en)) || it.short || it.description || it.desc || '';
  }

  function buildThumb(imgEl, key){
    let i=0;
    const trySet=()=>{ imgEl.src = IMG_DIR + key + '.' + IMG_EXTS[i]; };
    imgEl.onerror = ()=>{ i++; if(i<IMG_EXTS.length){ trySet(); } else { const t=imgEl.closest('.thumb'); if(t) t.classList.add('noimg'); imgEl.remove(); } };
    trySet();
  }

  // ---------- STATE ----------
  const cart=new Map(); let currentCat=null;

  // ---------- RENDER ----------
  function renderPills(){
    const keys=Object.keys(menuData); currentCat=currentCat||keys[0];
    const wrap=$('#catPills');
    wrap.innerHTML=keys.map(k=>`<button class="pill ${k===currentCat?'active':''}" data-cat="${k}">${catLabel(k)}</button>`).join('');
    wrap.onclick=e=>{
      const b=e.target.closest('.pill'); if(!b) return;
      $$('#catPills .pill').forEach(x=>x.classList.remove('active'));
      b.classList.add('active'); currentCat=b.dataset.cat;
      renderList();
    };
  }

  function renderList(){
    const wrap=$('#list'); const items=menuData[currentCat]||[]; const L=I18N[LANG];
    wrap.innerHTML=items.map((it,idx)=>{
      const name=itemName(it); const id=`${currentCat}:${idx}`; const qty=cart.get(id)||0; const price=it.price??0;
      const btn=qty
        ? `<div class="qty" data-qty="${id}"><button data-dec="${id}">‚àí</button><span>${qty}</span><button data-inc="${id}">+</button></div>`
        : `<button class="add" data-add="${id}">${L.add}</button>`;
      const descText=getDesc(it);
      return `
      <div class="card" data-id="${id}">
        <div class="thumb-wrap">
          <div class="thumb">${USE_IMAGES?`<img loading="lazy" decoding="async" alt="${name}">`:''}</div>
          <button class="info" title="–ü–æ–¥—Ä–æ–±–Ω–µ–µ" data-toggle="${id}">i</button>
        </div>
        <div class="name">${name}</div>
        ${descText?`<p class="desc">${descText}</p>`:''}
        <div class="foot">
          <div class="price">${fmt(price)}</div>
          ${btn}
        </div>
      </div>`;
    }).join('');

    // –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    if(USE_IMAGES){
      wrap.querySelectorAll('.card').forEach(row=>{
        const id=row.getAttribute('data-id'); const [cat,idx]=id.split(':');
        const key=(menuData[cat]?.[+idx]?.key)||''; const img=row.querySelector('.thumb img');
        if(img && key) buildThumb(img,key);
      });
    }
  }

  function renderCartSheet(){
    const lines=$('#cartLines'); const L=I18N[LANG];
    if(cart.size===0){lines.innerHTML=`<div class="muted">${L.cartEmpty}</div>`; $('#cartMeta').textContent=`${L.total}: `+fmt(0); return;}
    let sum=0; lines.innerHTML='';
    for(const [id,qty] of cart){
      const [cat,idx]=id.split(':'); const it=menuData[cat]?.[+idx]; if(!it) continue;
      const name=itemName(it); const lineSum=(it.price||0)*qty; sum+=lineSum;
      const el=document.createElement('div'); el.className='line';
      el.innerHTML=`<div><strong>${name}</strong><div class="muted">${fmt(it.price||0)} √ó ${qty}</div></div>
        <div class="qty" data-qty="${id}"><button data-dec="${id}">‚àí</button><span>${qty}</span><button data-inc="${id}">+</button></div>`;
      lines.appendChild(el);
    }
    $('#cartMeta').textContent=`${I18N[LANG].total}: `+fmt(sum);
  }

  function renderFab(){
    let items=0,sum=0;
    for(const [id,qty] of cart){ const [cat,idx]=id.split(':'); const it=menuData[cat]?.[+idx]; if(!it) continue; items+=qty; sum+=(it.price||0)*qty; }
    $('#fabText').textContent=`${items} ${I18N[LANG].itemsShort} ‚Ä¢ ${fmt(sum).replace(' ',' ')}`;
  }

  // ---------- UI TEXTS ----------
  function setUITexts(){
    const L=I18N[LANG];
    $('#navHome').textContent=`üè† ${L.navHome}`;
    $('#navMenu').textContent=`üçú ${L.navMenu}`;
    $('#navKaraoke').textContent=`üé§ ${L.navKaraoke}`;
    $('#navContact').textContent=`üìû ${L.navContact}`;
    $('#sheetTitle').textContent=L.sheetTitle;
    $('#orderTypeTitle').textContent=L.orderTypeTitle;
    $('#otOnSite').textContent=L.otOnSite;
    $('#otTakeaway').textContent=L.otTakeaway;
    $('#otDelivery').textContent=L.otDelivery;
    $('#tableLbl').innerHTML=`${L.tableLbl} <span class="muted">${L.phoneRequired}</span>`;
    $('#pickupLbl').innerHTML=`${L.pickupLbl} <span class="muted">${L.phoneRequired}</span>`;
    $('#addrLbl').innerHTML=`${L.addrLbl} <span class="muted">${L.phoneRequired}</span>`;
    $('#phoneLbl').childNodes[0].nodeValue=`${L.phoneLbl} `;
    $('#checkoutBtn').textContent=L.checkout;
    $('#clearBtn').textContent=L.clear;
    renderPills(); renderList(); renderCartSheet(); renderFab();
  }

  // ---------- EVENTS ----------
  document.addEventListener('click', e=>{
    const add=e.target.closest('[data-add]');
    if(add){const id=add.dataset.add; cart.set(id,(cart.get(id)||0)+1); renderList(); renderFab(); return;}
    const inc=e.target.closest('[data-inc]');
    if(inc){const id=inc.dataset.inc; cart.set(id,(cart.get(id)||0)+1); renderList(); renderCartSheet(); renderFab(); return;}
    const dec=e.target.closest('[data-dec]');
    if(dec){const id=dec.dataset.dec; const q=(cart.get(id)||0)-1; if(q<=0) cart.delete(id); else cart.set(id,q); renderList(); renderCartSheet(); renderFab(); return;}

    // —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ (–ø–æ ‚Äúi‚Äù –∏–ª–∏ –ø–æ –∫–ª–∏–∫—É –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ –≤–Ω–µ –∫–Ω–æ–ø–æ–∫)
    const infoBtn=e.target.closest('[data-toggle]');
    const cardEl=infoBtn ? document.querySelector(`.card[data-id="${infoBtn.dataset.toggle}"]`)
                         : e.target.closest('.card');
    if(cardEl && !e.target.closest('.add') && !e.target.closest('.qty')){
      cardEl.classList.toggle('expanded');
      return;
    }

    // –∫–æ—Ä–∑–∏–Ω–∞
    if(e.target.closest('#cartFab')){
      document.body.style.overflow='hidden';
      $('#overlay').classList.add('show');
      const sh=$('#sheet'); sh.classList.add('open'); sh.scrollTop=0;
      renderCartSheet(); return;
    }
    if(e.target.id==='overlay'){ closeSheet(); }

    if(e.target.id==='clearBtn'){ cart.clear(); renderList(); renderCartSheet(); renderFab(); }
  });

  function closeSheet(){
    document.body.style.overflow='';
    $('#overlay').classList.remove('show');
    $('#sheet').classList.remove('open');
  }

  // burger menu
  const burger=$('#burger'), navPop=$('#navPop');
  burger.addEventListener('click',()=>{const open=navPop.classList.toggle('open'); burger.setAttribute('aria-expanded',String(open));});
  document.addEventListener('click',e=>{if(!navPop.contains(e.target)&&e.target!==burger){navPop.classList.remove('open'); burger.setAttribute('aria-expanded','false');}});

  // order type
  const otWrap=$('#orderType'), tableField=$('#tableField'), takeawayField=$('#takeawayField'), addrField=$('#addrField');
  const tableNo=$('#tableNo'), pickupIn=$('#pickupIn'), address=$('#address'), phone=$('#phone'), phoneHint=$('#phoneHint');
  function show(el,on){el.style.display=on?'grid':'none'}
  function setPhoneHint(req){phoneHint.textContent=req?I18N[LANG].phoneRequired:I18N[LANG].phoneOptional}
  function setOrderType(v){
    if(v==='on_site'){show(tableField,true);show(takeawayField,false);show(addrField,false);setPhoneHint(false);tableNo.required=true;pickupIn.required=false;address.required=false;}
    else if(v==='takeaway'){show(tableField,false);show(takeawayField,true);show(addrField,false);setPhoneHint(true);tableNo.required=false;pickupIn.required=true;address.required=false;}
    else{show(tableField,false);show(takeawayField,false);show(addrField,true);setPhoneHint(true);tableNo.required=false;pickupIn.required=false;address.required=true;}
  }
  otWrap.addEventListener('click',e=>{const b=e.target.closest('[data-ot]'); if(!b) return; $$('#orderType .chip').forEach(x=>x.classList.remove('active')); b.classList.add('active'); setOrderType(b.dataset.ot);});

  // checkout
  $('#checkoutBtn').addEventListener('click',()=>{
    const L=I18N[LANG]; const ot=document.querySelector('#orderType .chip.active')?.dataset.ot;
    if(ot==='on_site'){ if(!tableNo.value.trim()){alert(L.alertTable);return;} }
    else if(ot==='takeaway'){ if(!pickupIn.value.trim()){alert(L.alertPickup);return;} if(!phone.value.trim()){alert(L.alertPhone);return;} }
    else { if(!address.value.trim()){alert(L.alertAddr);return;} if(!phone.value.trim()){alert(L.alertPhone);return;} }
    const meta=[]; if(ot==='on_site') meta.push(L.tableLbl+': '+tableNo.value.trim());
    if(ot==='takeaway') meta.push(L.pickupLbl+': '+pickupIn.value.trim()+' min');
    if(ot==='delivery') meta.push(L.addrLbl+': '+address.value.trim());
    if(phone.value.trim()) meta.push(L.phoneLbl+': '+phone.value.trim());
    alert(`${L.orderAccepted}\n${L.typeLabel}: ${I18N[LANG][ ot==='on_site'?'otOnSite': ot==='takeaway'?'otTakeaway':'otDelivery' ]}\n${meta.join('\n')}`);
    closeSheet();
  });

  // language
  const selA=$('#langSel'), selB=$('#langSelMenu');
  function setLang(v){
    LANG=v; selA.value=v; selB.value=v; document.documentElement.lang=v;
    setUITexts(); const activeOT=document.querySelector('#orderType .chip.active')?.dataset.ot||'on_site'; setOrderType(activeOT);
  }
  selA.addEventListener('change',e=>setLang(e.target.value));
  selB.addEventListener('change',e=>setLang(e.target.value));

  // ---------- INIT ----------
  (async ()=>{
    await loadDescriptions();
    setLang(LANG);
    renderPills(); renderList(); renderFab(); setOrderType('on_site');
  })();
  </script>
</body>
</html>
